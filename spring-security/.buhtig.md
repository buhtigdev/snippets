# Configuração do Spring Security com JWT

Quero implementar segurança na minha API REST com Spring Security e autenticação JWT seguindo as melhores práticas. Por favor, analise o contexto do projeto e execute as etapas necessárias para uma implementação completa e segura.

## Análise Inicial

Por favor, analise o projeto para:
1. Identificar o pacote base correto (verificar a estrutura de pacotes existente)
2. Verificar se o Spring Security já está parcialmente configurado
3. Identificar qual versão do Spring Boot está em uso
4. Verificar configurações de BD existentes para persistência de usuários

## Estrutura de Segurança

Configure o Spring Security com JWT incluindo:

### 1. Dependências Necessárias
- Spring Security
- JWT (jjwt-api, jjwt-impl, jjwt-jackson)
- Outras dependências necessárias

### 2. Modelo de Dados
- Entidade User com campos username, password, email e roles
- Repositório UserRepository para interação com banco de dados
- Classe Role para definir papéis de usuário (ROLE_USER, ROLE_ADMIN)

### 3. Configuração de Segurança
- SecurityConfig para configurar filtros e regras de segurança
- Configuração de CORS e CSRF
- Configuração de rotas públicas e protegidas
- Bean PasswordEncoder para codificação de senhas

### 4. Implementação JWT
- JwtService para geração e validação de tokens
- Filtro JwtAuthenticationFilter para processar tokens nas requisições
- Configuração de tempo de expiração de token
- Secrets e configurações seguras

### 5. Controllers de Autenticação
- AuthenticationController com endpoints de login e registro
- DTOs para Request e Response das operações de autenticação
- Validação de dados de entrada

### 6. Serviços
- UserService para gerenciamento de usuários
- AuthenticationService para autenticação e geração de tokens
- Implementação de UserDetailsService

## Testes e Validação

Verifique a implementação através de:
- Endpoints para cadastrar um novo usuário
- Endpoint de login que retorna JWT
- Endpoint protegido que requer autenticação
- Verificação da expiração do token
- Testes de roles e permissões

## Considerações de Segurança

Adicione proteções avançadas:
- Implementação de refresh tokens
- Blacklist para tokens invalidados
- Proteção contra ataques comuns (XSS, CSRF)
- Armazenamento seguro de secrets e configurações

Utilize o pacote correto do projeto e mantenha a estrutura de arquivos organizada por funcionalidade. 
